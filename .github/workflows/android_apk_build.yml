# File: .github/workflows/android_apk_build.yml (FINAL FIXED VERSION)
name: ðŸ¤– Android APK Builder - Rise of Sovereigns

# Workflow ini akan berjalan ketika Anda membuat rilis baru (tag)
on:
  push:
    tags:
      - 'v[0-9]+.[0-9]+.[0-9]+' # Dipicu saat Anda push tag seperti 'v1.0.0'

jobs:
  export_android:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code ðŸ›Žï¸
        uses: actions/checkout@v4
        
      - name: Set up Environment Variables
        # Mengatur versi Godot ke 4.5.1 sesuai permintaan Anda
        run: |
          echo "GODOT_VERSION=4.5.1" >> $GITHUB_ENV # <--- VERSI GODOT 4.5.1
          echo "GODOT_BRANCH=4" >> $GITHUB_ENV

      # --- LANKAH KRITIS: MENGGUNAKAN ACTION STABIL TERBARU ---
      - name: Export Game to Android APK ðŸš€
        uses: godot-ci/godot-actions/export@v5
        with:
          # Path proyek Anda
          project_path: ./ 
          # Target Ekspor
          target: Android
          # Nama output file APK
          output_name: Rise_of_Sovereigns
          # Menggunakan variabel versi 4.5.1
          godot_version: ${{ env.GODOT_VERSION }}
          version_branch: ${{ env.GODOT_BRANCH }}
          
          # CATATAN PENTING: Anda harus menyediakan Android Export Templates dan Keystore 
          # untuk membuat APK yang sebenarnya (Signed). Ini adalah langkah konfigurasi 
          # di luar kode YAML ini.

      - name: Upload Generated APK (Artifact) ðŸ“¦
        uses: actions/upload-artifact@v4
        with:
          name: Rise_of_Sovereigns_APK
          # Cari file APK yang dihasilkan
          path: ./build/Android/Rise_of_Sovereigns.apk 
